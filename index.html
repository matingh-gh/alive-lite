<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alive Lite – ترک تدریجی</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icons/192.png">
  <meta name="theme-color" content="#12141a" />
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Alive Lite</h1>
    <p class="subtitle">ترک تدریجی سیگار – ساخت خودت</p>
  </header>

  <nav class="nav-tabs">
    <button data-tab="onboarding" class="tab-btn active">شروع</button>
    <button data-tab="controls" class="tab-btn">کنترل</button>
    <button data-tab="stats" class="tab-btn">داشبورد</button>
    <button data-tab="history" class="tab-btn">تاریخچه</button>
    <button data-tab="profile" class="tab-btn">پروفایل</button>
  </nav>

  <main id="app">

    <!-- Onboarding -->
    <section id="onboarding" class="card">
      <h2>شروع شخصی‌سازی</h2>
      <label>چند نخ در روز می‌کشی؟ <input id="baseline" type="number" min="1" value="20"></label>
      <label>ساعت بیداری در روز؟ <input id="wake" type="number" min="8" max="20" value="16"></label>
      <label>کاهش هفتگی (%) <input id="reduce" type="number" min="3" max="15" value="8"></label>
      <button id="startPlan">شروع برنامه</button>
    </section>

    <!-- Controls -->
    <section id="controls" class="card hidden">
      <div class="phase">
        <span>فاز جاری: <b id="phaseIndex">1</b></span>
        <div class="phase-actions">
          <button id="advancePhase" title="رفتن به فاز بعد">ادامه به فاز بعد</button>
          <button id="stayPhase" title="ماندن در فاز فعلی">فعلاً همین فاز</button>
        </div>
      </div>
      <div class="timer">
        <p>فاصله هدف: <b id="targetInterval">—</b> دقیقه</p>
        <p>از آخرین سیگار: <b id="elapsed">—</b> دقیقه</p>
        <button id="logBtn">می‌خوام سیگار بکشم</button>
        <p id="waitMsg" class="warn hidden"></p>
      </div>
    </section>

    <!-- Dashboard -->
    <section id="stats" class="card hidden">
      <h2>داشبورد</h2>
      <div class="grid">
        <div class="kpi">
          <span>امروز کشیده‌ای</span>
          <b id="todayCount">0</b>
        </div>
        <div class="kpi">
          <span>میانگین ۷ روز</span>
          <b id="avg7">0</b>
        </div>
        <div class="kpi">
          <span>کاهش نسبت به پایه</span>
          <b id="reductionPct">0%</b>
        </div>
        <div class="kpi">
          <span>پول ذخیره‌شده</span>
          <b id="moneySaved">0</b>
        </div>
      </div>
      <label>قیمت هر نخ (تخمینی به تومان/یورو)
        <input id="pricePerCig" type="number" min="0" step="0.01" value="0.5">
      </label>
      <canvas id="chart" height="160"></canvas>
      <div class="actions">
        <button id="exportJson">خروجی JSON</button>
        <button id="resetApp" class="danger">شروع از اول</button>
      </div>
    </section>

    <!-- History -->
    <section id="history" class="card hidden">
      <h2>تاریخچهٔ روزانه</h2>
      <div id="historyList" class="list"></div>
    </section>

    <!-- Profile -->
    <section id="profile" class="card hidden">
      <h2>پروفایل‌ها</h2>
      <div class="profile-row">
        <select id="profileSelect"></select>
        <button id="newProfile">پروفایل جدید</button>
        <button id="deleteProfile" class="danger">حذف پروفایل</button>
      </div>
      <p class="muted">هر پروفایل تنظیمات و تاریخچهٔ جداگانه دارد (روی همین دستگاه).</p>
      <div class="auto-plan">
        <h3>تنظیم خودکار برنامه</h3>
        <label>حالت کاهش: 
          <select id="pace">
            <option value="easy">آهسته (۱۲ هفته)</option>
            <option value="normal" selected>نرمال (۸ هفته)</option>
            <option value="fast">سریع (۵ هفته)</option>
          </select>
        </label>
        <button id="autoPlanBtn">محاسبه برنامه</button>
        <p id="autoPlanMsg" class="muted"></p>
      </div>
      <div class="notify">
        <h3>اعلان</h3>
        <button id="enableNotif">فعال‌سازی اعلان</button>
        <p class="muted">اعلانِ «اجازهٔ سیگار بعدی» فقط زمانی که اپ باز باشد کار می‌کند. برای اعلان پس‌زمینه باید Push سرور داشته باشیم.</p>
      </div>
    </section>

  </main>

  <footer>
    <button id="installBtn" class="hidden">نصب روی Home Screen</button>
    <p class="footnote">نسخه آزمایشی – داده‌ها فقط روی این دستگاه ذخیره می‌شود.</p>
  </footer>

  <script src="app.js"></script>
</body>
</html>
